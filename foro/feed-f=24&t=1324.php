<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="es">
<link rel="self" type="application/atom+xml" href="http://losersjuegos.com.ar/foro/feed.php?f=24&amp;t=1324" />

<title>LosersJuegos</title>
<subtitle>Desarrollando videojuegos libres</subtitle>
<link href="http://losersjuegos.com.ar/foro/index.php" />
<updated>2011-10-27T18:57:11+00:00</updated>

<author><name><![CDATA[LosersJuegos]]></name></author>
<id>http://losersjuegos.com.ar/foro/feed.php?f=24&amp;t=1324</id>
<entry>
<author><name><![CDATA[borgo66]]></name></author>
<updated>2011-10-27T18:57:11+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6142#p6142</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6142#p6142"/>
<title type="html"><![CDATA[Re: Ayuda con mi intento de maquina de estados]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6142#p6142"><![CDATA[
Gracias por responder<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2420">borgo66</a> — Jue Oct 27, 2011 6:57 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[MrBB4]]></name></author>
<updated>2011-10-24T23:01:06+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6141#p6141</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6141#p6141"/>
<title type="html"><![CDATA[Re: Ayuda con mi intento de maquina de estados]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6141#p6141"><![CDATA[
<blockquote class="uncited"><div><br />@Borgo66: No deberia cada estado tomar el control del la variable current_animation del personaje?<br /></div></blockquote><br />La verdad cuando se trata de programación no importa como uno escriba un programa. Claro, existen patrones y formas comunes de hacer las cosas pero eso no quiere decir que haya siempre que seguir un orden especifico de como hacer las cosas. Cada unos escribe su codigo como se le de la gana. Como lo escribí yo era porque como ya habias creado un diccionario dentro del personaje con los frames determinador para cada estado en: <br /><pre class="prettyprint">self.animations = {&#39;guardia&#39;: Animation&#40;self.x2frames,&#39;1,2,3,4,5&#39;&#41;,<br />                   &#39;saltar&#39;:  Animation&#40;self.x2frames,&#39;76,77,76&#39;&#41;,<br />                   &#39;intro&#39;: Animation&#40;self.x2frames,&#39;181,182,183,184,185,186,187,188,189,190,191,192,193&#39;&#41;}</pre><br />me parecio que lo mejor era aprovechar eso y así se ahorraban un par de lineas de codigo. Pero de la forma en que lo hiciste tú tambien es valido. Escribe el programa como se te haga más comodo. Si lo que quieres es mantener todo bien ordenado dentro de clases, pues mantenlo así <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_wink.gif" alt=";)" title="Wink" /><br /><br />Saludos y (nuevamente) suerte en el proyecto.<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2357">MrBB4</a> — Lun Oct 24, 2011 11:01 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[borgo66]]></name></author>
<updated>2011-10-24T19:21:17+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6140#p6140</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6140#p6140"/>
<title type="html"><![CDATA[Re: Ayuda con mi intento de maquina de estados]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6140#p6140"><![CDATA[
<span style="font-weight: bold">MrBB4</span> : gracias por responder pero no llego a entender que esta pasando exactamente.No deberia  cada estado tomar el control del la variable current_animation del personaje?, no se si probaste hacer esto<br />en la funcion update del personaje:<br /><pre class="prettyprint">def update&#40;self&#41;:<br />    key = pygame.key.get_pressed&#40;&#41;<br />    if key[K_a]:<br />        self.set_state&#40;Guardia&#40;self&#41;&#41;</pre><br />De esta manera si funciona, creo que eso me confunde.<br /><br /><span style="font-weight: bold">Barajas</span>: Muchas gracias por el codigo que subiste lo estuve ojeando y creo es bastante similar al mio, lo de funciones en vez de clases para manejar estados ya lo habia pensado pero lo quiero hacer con clases, me parece mas prolijo y extensible sobre todo para usarlo en otros juegos .<br />Ademas el &quot;modelo&quot; de fsm que use es casi igual al usado por el autor del libro &quot;Beginning Game Development with Pygame&quot;(Will McGugan)<br />Pero igual si tenes alguna sugerencia, se agradece y sepan disculpar la insistencia pero soy un principiante en el mundo de la programacion.<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2420">borgo66</a> — Lun Oct 24, 2011 7:21 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Barajas]]></name></author>
<updated>2011-10-22T11:17:12+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6137#p6137</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6137#p6137"/>
<title type="html"><![CDATA[Re: Ayuda con mi intento de maquina de estados]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6137#p6137"><![CDATA[
Que curioso, precisamente ayer estaba explicando eso y su implementación para un juego de peleas XD...<br /><br />Para ser sincero, me parece que hay una mejor y mas sencilla forma de implementarlos, pero me parece bastante bien hasta donde has llegado <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Por si te interna, adjunto los ejemplos que había hecho para explicárselo a mis compañeros <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_smile.gif" alt=":)" title="Smile" />.<br /><br />P.D.<br />También era el ejemplo con un juego de peleas jeje.. <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2345">Barajas</a> — Sab Oct 22, 2011 11:17 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[MrBB4]]></name></author>
<updated>2011-10-21T23:01:32+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6136#p6136</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6136#p6136"/>
<title type="html"><![CDATA[Re: Ayuda con mi intento de maquina de estados]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6136#p6136"><![CDATA[
Oooook. Me tomó un buen tiempo encotrar el bug, pero ya lo pillé. Resulta que en las clases <span style="font-style: italic">Intro()</span>, <span style="font-style: italic">Saltar()</span> y <span style="font-style: italic">Guardia()</span> se redefine en cada una de ellas cuales son las imagenes correspondientes para el personaje, la cosa es que creaste los estados (siendo el ultimo el de <span style="font-style: italic">Guradia()</span>), luego las metiste dentro de una lista y las llamate con el metodo update, pero no vuelves a redefinir en ningún otro momento los frames correspondientes a las otras funciones, y como la ultima que creaste fue <span style="font-style: italic">Guardia()</span> cualquiera de los otros estados llamará a estos mismos frames. Para que te des cuenta por ti mismo deja a <span style="font-style: italic">Luchador()</span> así:<br /><pre class="prettyprint">class Luchador&#40;Sprite&#41;:<br />    def __init__&#40;self, archivo, filas, columnas&#41;:<br />        Sprite.__init__&#40;self&#41;<br />        self.states = {}<br /><br />        self.frames = load_spritesheet&#40;archivo,filas,columnas&#41;<br />        self.x2frames = self.double_sized_images&#40;&#41;<br /><br />        self.animations = {&#39;guardia&#39;: Animation&#40;self.x2frames,&#39;1,2,3,4,5&#39;&#41;,<br />                           &#39;saltar&#39;:  Animation&#40;self.x2frames,&#39;76,77,76&#39;&#41;,<br />                           &#39;intro&#39;: Animation&#40;self.x2frames,&#39;181,182,183,184,185,186,187,188,189,190,191,192,193&#39;&#41;}<br />        intro = Intro&#40;self&#41;<br />        saltar = Saltar&#40;self&#41;<br />        #guardia = Guardia&#40;self&#41;<br /><br />        self.add_state&#40;intro&#41;<br />        #self.add_state&#40;guardia&#41;<br />        self.add_state&#40;saltar&#41;<br /><br />        self.set_state&#40;&quot;intro&quot;&#41;<br />        <br />        ················Resto del código················</pre><br />Ahora en vez de quedarse la animación pegada en Guardia, se quedará pegada en Saltar. Para solucionar esto simplemente debes poner la función <span style="font-style: italic">luchador.set_animation()</span> dentro de la función <span style="font-style: italic">set_state()</span>, quedandonos así:<br /><pre class="prettyprint">def set_state&#40;self,sname&#41;:<br />         self.current_state = self.states[sname]<br />         self.set_animation&#40;sname&#41;</pre><br /><br />Ahora si. Pero te quedan tres lineas de codigo que se pueden reducir a una sola. Quita la linea que dice <span style="font-style: italic">self.luchador.set_animation(anim_id)</span> de las clases <span style="font-style: italic">Intro()</span>, <span style="font-style: italic">Saltar()</span> y <span style="font-style: italic">Guardia()</span>, y agrega <span style="font-style: italic">self.set_animation(&quot;intro&quot;)</span> en la clase Luchador() despues de <span style="font-style: italic">self.set_state(&quot;intro&quot;)</span>.<br />Te aseguro que funciona, ya lo probé.<br /><br />Cualquier otra cosa, pregunta. Fue un gusto debugear tu codigo.<br />Suerte en tu proyecto <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_wink.gif" alt=";)" title="Wink" /><p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2357">MrBB4</a> — Vie Oct 21, 2011 11:01 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[borgo66]]></name></author>
<updated>2011-10-21T19:56:59+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6134#p6134</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6134#p6134"/>
<title type="html"><![CDATA[Ayuda con mi intento de maquina de estados]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=1324&amp;p=6134#p6134"><![CDATA[
Hola a todos, nesecito ayuda con el siguiente codigo:<br /><pre class="prettyprint">import pygame<br />from pygame.locals import*<br />from pygame.sprite import Sprite<br />import os<br /><br />ANCHO = 640<br />ALTO = 480<br /><br />def load_spritesheet&#40;archivo,filas,columnas&#41;:<br />    fullname = os.path.join &#40;&#39;data&#39;, archivo&#41;<br />    img=pygame.image.load&#40;fullname&#41;.convert&#40;&#41;<br />    images=[]<br />    alto=img.get_height&#40;&#41;/filas<br />    ancho=img.get_width&#40;&#41;/columnas<br />    aux_img=pygame.Surface&#40;&#40;ancho,alto&#41;&#41;<br /><br />    for i in range&#40;filas&#41;:<br />        for j in range&#40;columnas&#41;:<br />            aux_img=pygame.Surface&#40;&#40;ancho,alto&#41;&#41;<br />            area=pygame.Rect&#40;j*ancho,i*alto,ancho,alto&#41;<br />            aux_img.blit&#40;img,&#40;0,0&#41;,area&#41;<br />            aux_img=aux_img.convert&#40;&#41;<br />            aux_img.set_colorkey&#40;aux_img.get_at&#40;&#40;0,0&#41;&#41;&#41;<br />            images.append&#40;aux_img&#41;<br />    return images<br /><br />class Animation&#40;object&#41;:<br />    def __init__&#40;self, ima, str_frames = &quot;&quot;&#41;:<br />        self.imagenes = ima<br />        self.frames = self.load_frames&#40;str_frames&#41;<br />        self.image = self.imagenes[self.frames[0]]<br />        self.rect = self.image.get_rect&#40;&#41;<br />        self.step = 0<br />        self.delay = 0<br />        self.index = self.frames[0]<br />        self.longitud = len&#40;self.frames&#41;<br /><br />    def load_frames&#40;self,frames&#41;:<br />        lista = []<br />        frames = frames.split&#40;&#39;,&#39;&#41;<br />        for i in frames:<br />            lista.append&#40;int&#40;i&#41;&#41;<br />        return lista<br /><br />    def set_frame&#40;self, indice&#41;:<br />        self.image = self.imagenes[indice]<br /><br />    def update&#40;self, delay = 9&#41;:<br />        if self.step &gt;= self.longitud-1:<br />            self.end =  True<br />            self.step = 0<br />        self.delay -= 1<br />        if self.delay &lt;= 0:<br />            self.delay = delay<br />            self.step += 1<br />        self.set_frame&#40;self.frames[self.step]&#41;<br /><br />    def draw&#40;self,screen&#41;:<br />        screen.blit&#40;self.image,self.rect&#41;<br /><br />class State&#40;object&#41;:<br />    def __init__&#40;self,luchador,state_name&#41;:<br />        self.luchador = luchador<br />        self.name = state_name<br /><br />    def update&#40;self&#41;:<br />        pass<br /><br />class Intro&#40;State&#41;:<br />    def __init__&#40;self, luchador&#41;:<br />        State.__init__&#40;self,luchador,&quot;intro&quot;&#41;<br />        self.luchador.set_animation&#40;&#39;intro&#39;&#41;<br /><br />    def update&#40;self&#41;:<br />        self.luchador.current_animation.update&#40;&#41;<br /><br />class Guardia&#40;State&#41;:<br />    def __init__&#40;self, luchador&#41;:<br />        State.__init__&#40;self,luchador,&quot;guardia&quot;&#41;<br />        self.luchador.set_animation&#40;&#39;guardia&#39;&#41;<br /><br />    def update&#40;self&#41;:<br />        self.luchador.current_animation.update&#40;&#41;<br /><br /><br />class Saltar&#40;State&#41;:<br />    def __init__&#40;self, luchador&#41;:<br />        State.__init__&#40;self,luchador,&quot;saltar&quot;&#41;<br />        self.luchador.set_animation&#40;&#39;saltar&#39;&#41;<br /><br />    def update&#40;self&#41;:<br />        self.luchador.current_animation.update&#40;&#41;<br /><br /><br />class Luchador&#40;Sprite&#41;:<br />    def __init__&#40;self, archivo, filas, columnas&#41;:<br />        Sprite.__init__&#40;self&#41;<br />        self.states = {}<br /><br />        self.frames = load_spritesheet&#40;archivo,filas,columnas&#41;<br />        self.x2frames = self.double_sized_images&#40;&#41;<br /><br />        self.animations = {&#39;guardia&#39;: Animation&#40;self.x2frames,&#39;1,2,3,4,5&#39;&#41;,<br />                           &#39;saltar&#39;:  Animation&#40;self.x2frames,&#39;76,77,76&#39;&#41;,<br />                           &#39;intro&#39;: Animation&#40;self.x2frames,&#39;181,182,183,184,185,186,187,188,189,190,191,192,193&#39;&#41;}<br />        intro = Intro&#40;self&#41;<br />        saltar = Saltar&#40;self&#41;<br />        guardia = Guardia&#40;self&#41;<br /><br />        self.add_state&#40;intro&#41;<br />        self.add_state&#40;guardia&#41;<br />        self.add_state&#40;saltar&#41;<br /><br />        self.set_state&#40;&quot;intro&quot;&#41;<br /><br />    def set_animation&#40;self, anim_id&#41;:<br />        self.current_animation = self.animations[anim_id]<br /><br />    def get_animation&#40;self,anim_id&#41;:<br />        return self.animations[anim_id]<br /><br /><br />    def add_state&#40;self, state&#41;:<br />        self.states[state.name] = state<br /><br />    def set_state&#40;self,sname&#41;:<br />         self.current_state = self.states[sname]<br /><br />    def double_sized_images&#40;self&#41;:<br />        frames2x = []<br />        for i in range &#40;len&#40;self.frames&#41;-1&#41;:<br />            frames2x.append&#40;pygame.transform.scale2x&#40;self.frames[i]&#41;&#41;<br />        return frames2x<br /><br />    def update&#40;self&#41;:<br />        self.current_state.update&#40;&#41;<br /><br />        key = pygame.key.get_pressed&#40;&#41;<br />        if key[K_a]:<br />            self.set_state&#40;&quot;saltar&quot;&#41;<br />        if key[K_s]:<br />            self.set_state&#40;&quot;guardia&quot;&#41;<br /><br /><br />    def draw&#40;self, screen&#41;:<br />        self.current_animation.draw&#40;screen&#41;<br /><br /><br />def main&#40;&#41;:<br />  quit = False<br />  screen = pygame.display.set_mode&#40;&#40;ANCHO, ALTO&#41;&#41;<br /><br />  luchador = Luchador&#40;&quot;Ryu.png&quot;,17,15&#41;<br /><br />  clock =  pygame.time.Clock&#40;&#41;<br /><br />  while not quit:<br />    clock.tick&#40;60&#41;<br />    for event in pygame.event.get&#40;&#41;:<br />        if event.type == pygame.QUIT:<br />            quit = True<br /><br />    screen.fill&#40;&#40;200, 200, 200&#41;&#41;<br /><br />    luchador.update&#40;&#41;<br />    print luchador.current_state<br />    luchador.draw&#40;screen&#41;<br /><br />    pygame.display.flip&#40;&#41;<br /><br />if __name__ == &#39;__main__&#39;:<br />    pygame.init&#40;&#41;<br />    main&#40;&#41;</pre><br /><br /><br />Cuando se produce un cambio de estado del personaje, al presionar una tecla, NO se produce el cambio de animacion corespondiente a ese estado, no se si esta claro lo que pregunto.<br />Por las dudas pueden correr el codigo ustedes:<br />(la imagen debe estar en la carppeta &quot;data&quot; y el script en el mismo directorio que &quot;data&quot;)<br /><a href="http://www.mediafire.com/?q919bsu39200qd7" class="postlink">http://www.mediafire.com/?q919bsu39200qd7</a><br />Desde ya les estare muy agradecido por la ayuda.<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2420">borgo66</a> — Vie Oct 21, 2011 7:56 pm</p><hr />
]]></content>
</entry>
</feed>