<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="es" xml:lang="es">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="es" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="copyright" content="2000, 2002, 2005, 2007 phpBB Group" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

<title>LosersJuegos &bull; Ver Tema - C++ y Lua para videojuegos</title>

<link rel="alternate" type="application/atom+xml" title="Feed - LosersJuegos" href="feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - Nuevos Temas" href="feed-mode=topics.php" /><link rel="alternate" type="application/atom+xml" title="Feed - Foro - Sobre lenguajes de programación" href="feed-f=8.php" /><link rel="alternate" type="application/atom+xml" title="Feed - Tema - C++ y Lua para videojuegos" href="feed-f=8&amp;t=1068.php" />

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:

	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Introduzca el número de página al que desea saltar:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/; domain=.losersjuegos.com.ar';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<script type="text/javascript" src="styles/prosilver/template/styleswitcher.js"></script>
<script type="text/javascript" src="styles/prosilver/template/forum_fn.js"></script>

<link href="styles/prosilver/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="style.php-id=3&amp;lang=en&amp;sid=4ec7bd6b5b400f7171476bb35f8261c6.css" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="styles/prosilver/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="styles/prosilver/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="styles/prosilver/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />




<link href="styles/prosilver/theme/header.css" rel="stylesheet" type="text/css"/>
<link href="styles/prosilver/theme/barrausuario.css" rel="stylesheet" type="text/css"/>
<link href="styles/prosilver/theme/design.css" rel="stylesheet" type="text/css"/>

<link href="styles/prosilver/theme/src/prettify.css" type="text/css" rel="stylesheet" />
<script src="styles/prosilver/theme/src/prettify.js" type="text/javascript"></script>


</head>


<body onload="prettyPrint()" id="phpbb" class="section-viewtopic ltr">

<div id="wrap">
<div id='borde'>

    <div id="cabecera">

        <a href='index.html'><img id='logo1' alt='' src="styles/prosilver/theme/ima_cabecera/logo_1.png" width="286" height="50" name="logo1" /></a>

        <div id="navi">
            <ul>
                <li><a href="../index.html">Web</a></li>
                <li id='actual'><a href="index.html">Foro</a></li>
            </ul>
        </div>

    </div>


<div class='barra_usuario'>
        <ul>
                <li class='regresar'><a href='../index.html'>Regresar a la web</a></li>
                <li class='buscar'><a href="search.php.html">Buscar</a></li>

                
                <li class='registrar'><a href="ucp.php-mode=register.html">Registrarse</a></li>

                <li class='registrar'><a href="ucp.php-mode=login.html">Identificarse</a>
                </li>
                

        </ul>
</div>




	<a name="start_here"></a>
	<div id="page-body">
		<ul style='font-size: 14px' class="linklist">
                    <li class="icon-home"><a href="index.php.html" accesskey="h">Índice general</a></li>
                    </ul>
<h2><a href="viewtopic.php-f=8&amp;t=1068&amp;start=0.html">C++ y Lua para videojuegos</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Agrupa todas las consultas sobre los lenguajes de programacion como C, C++, Python, Java ...<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="posting.php-mode=reply&amp;f=8&amp;t=1068.html" title="Publicar una respuesta"><span></span>Publicar una respuesta</a></div>
	
	</div>

	
		<div class="search-box">
			<form method="post" id="topic-search" action="search.php-t=1068.html">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Buscar este tema…" onclick="if(this.value=='Buscar este tema…')this.value='';" onblur="if(this.value=='')this.value='Buscar este tema…';" />
				<input class="button2" type="submit" value="Buscar" />
				<input type="hidden" value="1068" name="t" />
				<input type="hidden" value="msgonly" name="sf" />
			</fieldset>
			</form>
		</div>
	
		<div class="pagination">
			14 mensajes
			 &bull; Página <strong>1</strong> de <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p5171" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="#p5171">C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5171.html#p5171"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a></strong> &raquo; Sab Mar 05, 2011 6:32 am </p>

			

			<div class="content">Hola Gente,<br />he estado ocupado estos dias por eso he tenido poca actividad en el foro,<br />bueno estos dias investigando un poco sobre motores de juegos 2d, encontre uno llamado &quot;LÖVE&quot;<br />(<!-- m --><a class="postlink" href="http://love2d.org/">http://love2d.org/</a><!-- m -->) y me ha gustado mucho principalmente porque este programa es solo<br />un ejecutable, a este se le entrega un carpeta que contiene un archivo en lua (main.lua), en dicho<br />archivo se escribe el codigo del juego que luego se interpreta con el motor.<br /><br />me parece interesante dicho motor porque creo que facilita la distribucion de juegos, y ademas<br />porque tiene distintos modulos muy utiles, como poder controlar particulas, fisica, imagenes, en otros.<br /><br />mi pregunta es ¿como se puede desarrollar un ejecutable en c++ el cual sea capaz de interpretar codigo lua?.<br /><br />este ejecutable seria algo asi como un interprete de codigo lua que llame funciones c++ (podrian ser de SFML O SDL).<br /><br />Saludos y espero su colaboracion.<br /><br />Gracias de Antemano.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5171">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 106</dd><dd><strong>Registrado:</strong> Lun Dic 13, 2010 12:23 am</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5172" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5172">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5172.html#p5172"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a></strong> &raquo; Sab Mar 05, 2011 8:45 am </p>

			

			<div class="content">Hola, este es un tutorial de como integrar Lua en C++ usando swig que es un programa que hace el port de C++ a código reconocible por Lua. <a href="http://www.swig.org/Doc1.3/Lua.html#Lua_nn7" class="postlink">http://www.swig.org/Doc1.3/Lua.html#Lua_nn7</a>.<br /><br />Al principio tiene el ejemplo de una aplicación que llama al interprete y sin embargo tiene cargado un módulo que es el código en C++ ya traducido en llamadas a la biblioteca de lua para realizar todo. por lo que si compilas ese ejemplo te va a decir que no se puede linkear esa función. Esto es por que existen dos formas de hacer lo que quieres, una es creando el módulo e incluirlo en un programa que va a ser el que incluya el módulo y el interprete. la otra es hacer como dice en la guia una biblioteca dinámica en los dos casos se tiene que usar swig para hacer el port todos los archivos se incluyen para ser compilados junto con el código que arroja el swig, con esto se crea un biblioteca dinámica que puede ser llamada desde un programa en C++, en este caso no se usa el interprete, pero la misma biblioteca puedes usarla abriendo el interprete de lua y llamando a la biblioteca dinámica, este es un ejemplo de un programa que hice:<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#!/usr/bin/lua<br />require(&quot;libtank_war&quot;)<br />g=libtank_war.game();<br />g:init_video(800,600,32);<br />--a=libtank_war.audio();<br />--a:add_chunk(&quot;../sounds/disp.wav&quot;);<br />--a:add_chunk(&quot;../sounds/disp_mis.wav&quot;);<br />--a:add_audio(&quot;../sounds/intro.ogg&quot;);<br />--a:reproducir();<br /><br />g.scene:set_world(&quot;../images/terreno/path&quot;);<br />g.scene:add_sprite(&quot;../images/E-P8.854.png&quot;,1);<br />g.scene:add_sprite(&quot;../images/anillo.png&quot;,1);<br />g.scene:add_sprite(&quot;../images/explode1.png&quot;,7);<br />.<br />.<br />.<br /></code></dd></dl><br />Si te das cuenta la primera linea esta para que cuando le de doble clic se abra el interprete la función require es la forma en la que se llama a la biblioteca dinámica desde lua, la versión que uso es 5.1, la forma de llamar cambia en la 5.0<br /><br />pero modificando un poco el código que tiene de ejemplo el tutorial quedando así:<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>extern &quot;C&quot; {<br />&nbsp; &nbsp;#include &quot;lua5.1/lua.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lualib.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lauxlib.h&quot;<br />}<br />#include&lt;iostream&gt;<br />using namespace std;<br /><br /><br />int main(int argc,char* argv&#91;&#93;)<br />{<br />&nbsp; &nbsp;lua_State *L;<br /> <br /> if (argc&lt;2)<br /> {<br />&nbsp; printf(&quot;%s: &lt;filename.lua&gt;\n&quot;,argv&#91;0&#93;);<br />&nbsp; return 0;<br /> }<br /> L=lua_open();<br /> luaL_openlibs(L);&nbsp; &nbsp;// load basic libs (eg. print)<br /> <br /> if (luaL_loadfile(L,argv&#91;1&#93;)==0) // load and run the file <br /> {<br />&nbsp; &nbsp; cout&lt;&lt;&quot;Control sedido al interpreter&quot;&lt;&lt;endl;<br />&nbsp; lua_pcall(L,0,0,0);<br />}<br /> else<br />&nbsp; printf(&quot;Error al cargar %s\n&quot;,argv&#91;1&#93;);<br /> lua_close(L);<br /> cout&lt;&lt;&quot;Programa terminado&quot;&lt;&lt;endl;<br /> return 0;<br />&nbsp; <br />&nbsp; &nbsp;<br />}<br /></code></dd></dl><br /><br />Queda el interprete compilado en un ejecutable, por lo que no tiene que estar presente el ejecutable del interprete pero si sus bibliotecas dinámicas. El código anterior carga un archivo lua y lo ejecuta. podrías pasarle un archivo que contenga:<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>x=3+2*2<br />print(x)</code></dd></dl><br />y se va a ejecutar.<br /><br />De esta forma no está cargado ni un módulo es solo el interprete en sí, por lo que en teoría deberías poder cargar cualquier biblioteca dinámica preparada para ser interpretada y esta se debe ejecutar, de hecho hice la prueba y ejecuté el primer código en lua que mostré, y se ejecuto correctamente. Sobre la biblioteca libtank_war se tiene que encontrar en un directorio específico para que el interprete lo tome, o bien indicarle la ruta completa.<br /><br />En el tutorial vas a encontrar ejemplos y vas a ver todo lo que se puede hacer con Lua y C++, comienza por lo sencillo, has un pequeño programa en c++ de una función hace el port con swig e intenta llamarla con el interprete.<br />En el tutorial no explica una cosa importante, al hacer el port swig recibe un archivo con terminación .i que es la declaración de las funciones, clases, etc de lo que tiene que portar, se hace asi:<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>%module libtank_war<br />%{<br />#include &quot;otras_declaraciones.h&quot;<br /><br />%}<br />%include &lt;typemaps.i&gt;<br />class top{ <br />&nbsp; &nbsp; &nbsp; &nbsp;public:<br />&nbsp; &nbsp; &nbsp; &nbsp;int x,y;<br />&nbsp; &nbsp; &nbsp; &nbsp;int suma(x,y){return x+y;}<br /><br /><br />};<br /></code></dd></dl><br /><br />este archivo únicamente requiere los prototipos pues al compilar se llama a los .cpp aunque se pueden definir en el mismo código las funciones y también funciona.<br />Luego solo ejecutas: swig -c++ -lua example.i<br />y obtendrás un archivo para incluir en tu biblioteca dinámica. Al principio del tuto hay una así que sirve de ejemplo para desarrollar lo demás.<br />Para finalizar, en la página oficial de Lua puedes descargar las fuentes, me parece que hay para win, al igual que swig.<br />Saludos.</div>

			<div id="sig5172" class="signature">El conocimiento de unos es conocimiento de todos.</div>

		</div>

		
			<dl class="postprofile" id="profile5172">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html"><img src="download/2124-avatar=2124_1283282608.jpg" width="70" height="53" alt="Avatar de Usuario" /></a><br />
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 249</dd><dd><strong>Registrado:</strong> Mar Jul 14, 2009 4:13 am</dd><dd><strong>Ubicación:</strong> mexico</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5173" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5173">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5173.html#p5173"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a></strong> &raquo; Sab Mar 05, 2011 5:58 pm </p>

			

			<div class="content">LÖVE es como un intérprete en el que están totalmente integradas las bibliotecas SDL, OpenGL, OpenAL y PHYSFS.<br /><br /><blockquote class="uncited"><div>¿como se puede desarrollar un ejecutable en c++ el cual sea capaz de interpretar codigo lua?.<br /></div></blockquote><br /><br />Primero necesitas un estado de lua, vamos una máquina virtual. Luego ejecutas el código desde archivos de texto o desde simple cadenas de texto de forma sencilla con funciones facilitadas por la biblioteca de lua.<br /><br /><blockquote class="uncited"><div>este ejecutable seria algo asi como un interprete de codigo lua que llame funciones c++ (podrian ser de SFML O SDL).<br /></div></blockquote><br /><br />Para eso tienes primero que crear funciones en un formato requerido para lua, por ejemplo &quot;LimpiarPantalla&quot; en SFML y sin entrar en detalles:<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>static int limpiarpantalla(lua_State *vm){<br />&nbsp; &nbsp; miventana-&gt;Clear();<br />&nbsp; &nbsp; return 0;}<br /></code></dd></dl><br /><br />Luego lo registras en lua bajo un nombre, sin más complicaciones &quot;LimpiarPantalla&quot;, y ya luego lo llamas cómodamente desde lua como LimpiarPantalla()<br /><br />@carlostex<br /><br />Personalmente paso de SWIG, para python quizá valga la pena, pero para una cosa tan sencilla como lua ya me hago sin complicaciones mis modulos y mi propios objetos a mano para ser usados en lua. Se arma una clase base abstracta llamada &quot;proxy&quot; para poder usar cómodamente objetos en C++ desde lua. Se crea en lua un puntero a puntero de proxy, almacenas el objeto que hereda la clase proxy ahí, y le asignas una metatabla con funciones escritas en C/C++ para acceder al objeto y listo.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5173">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 38</dd><dd><strong>Registrado:</strong> Dom Oct 01, 2006 4:41 pm</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5174" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5174">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5174.html#p5174"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a></strong> &raquo; Sab Mar 05, 2011 6:08 pm </p>

			

			<div class="content">Saludos Gracias por tu respuesta Carlos ha sido de mucha ayuda,<br />mira ya me resulto este código:<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>extern &quot;C&quot; {<br />&nbsp; &nbsp;#include &quot;lua5.1/lua.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lualib.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lauxlib.h&quot;<br />}<br />#include&lt;iostream&gt;<br />using namespace std;<br /><br /><br />int main(int argc,char* argv&#91;&#93;)<br />{<br />&nbsp; &nbsp;lua_State *L;<br /><br />if (argc&lt;2)<br />{<br />&nbsp; printf(&quot;%s: &lt;filename.lua&gt;\n&quot;,argv&#91;0&#93;);<br />&nbsp; return 0;<br />}<br />L=lua_open();<br />luaL_openlibs(L);&nbsp; &nbsp;// load basic libs (eg. print)<br /><br />if (luaL_loadfile(L,argv&#91;1&#93;)==0) // load and run the file<br />{<br />&nbsp; &nbsp; cout&lt;&lt;&quot;Control sedido al interpreter&quot;&lt;&lt;endl;<br />&nbsp; lua_pcall(L,0,0,0);<br />}<br />else<br />&nbsp; printf(&quot;Error al cargar %s\n&quot;,argv&#91;1&#93;);<br />lua_close(L);<br />cout&lt;&lt;&quot;Programa terminado&quot;&lt;&lt;endl;<br />return 0;<br /> <br />&nbsp; &nbsp;<br />}<br /></code></dd></dl><br /><br />ahora he estado intentanto crear un modulo he incorporarlo al programa cpp pero no me resulta,<br />te explico: <br />cree un archivo &quot;example.i&quot; con lo siguiente<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>%module example<br />%{<br />#include &quot;example.h&quot;<br />%}<br />void imprimir();<br /><br /></code></dd></dl><br /><br />example.h puse esto:<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#ifndef EXAMPLE_H<br />#define EXAMPLE_H<br /><br />void imprimir();<br /><br />#endif<br /><br /></code></dd></dl><br />example.cpp puse esto:<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#include &lt;iostream&gt;<br /><br />using namespace std;<br /><br />void imprimir(){<br /><br />cout &lt;&lt; &quot;Funciono Modulo&quot; &lt;&lt; endl;<br /><br />}<br /></code></dd></dl><br />y en el código donde esta main<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>extern &quot;C&quot; {<br />&nbsp; &nbsp;#include &quot;lua5.1/lua.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lualib.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lauxlib.h&quot;<br />}<br /><br />#include&lt;iostream&gt;<br /><br /><br />using namespace std;<br /><br />extern int luaopen_example(lua_State* L); // declare the wrapped module<br /><br /><br />int main(int argc,char* argv&#91;&#93;)<br />{<br />&nbsp; &nbsp;lua_State *L;<br /><br />if (argc&lt;2)<br />{<br />&nbsp; printf(&quot;%s: &lt;main.lua&gt;\n&quot;,argv&#91;0&#93;);<br />&nbsp; return 0;<br />}<br />L=lua_open();<br />luaL_openlibs(L);&nbsp; &nbsp;// load basic libs (eg. print)<br />luaopen_example(L);&nbsp; &nbsp;// load the wrappered module<br /><br />if (luaL_loadfile(L,argv&#91;1&#93;)==0) // load and run the file<br />{<br />&nbsp; &nbsp; cout&lt;&lt;&quot;Control sedido al interpreter&quot;&lt;&lt;endl;<br />&nbsp; lua_pcall(L,0,0,0);<br />}<br />else<br />&nbsp; printf(&quot;Error al cargar %s\n&quot;,argv&#91;1&#93;);<br />lua_close(L);<br />cout&lt;&lt;&quot;Programa terminado&quot;&lt;&lt;endl;<br />return 0;<br /> <br />&nbsp; &nbsp;<br />}<br /></code></dd></dl><br /><br />el problema es que no reconoce la función <br />    extern int luaopen_example(lua_State* L);<br />y no se como se traen el modulo example.h para que lo reconosca lua.<br /><br />PD: el comando g++ que estoy usando es<br />      g++ &quot;codigo.cpp&quot; &quot;example_wrap.cxx&quot; &quot;example.cpp&quot; -o &quot;codigo&quot; -llua5.1<br /><br />seria esa mi pregunta y muchas gracias por la ayuda.<br /><br />Saludos  <img src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			

		</div>

		
			<dl class="postprofile" id="profile5174">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 106</dd><dd><strong>Registrado:</strong> Lun Dic 13, 2010 12:23 am</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5175" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5175">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5175.html#p5175"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a></strong> &raquo; Sab Mar 05, 2011 10:25 pm </p>

			

			<div class="content">Si, lo que sucede es que la definición de esa función es la que creó swig, tienes que incluir es archivo *.cxx en el main, y prueba si funciona, con esto debería.</div>

			<div id="sig5175" class="signature">El conocimiento de unos es conocimiento de todos.</div>

		</div>

		
			<dl class="postprofile" id="profile5175">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html"><img src="download/2124-avatar=2124_1283282608.jpg" width="70" height="53" alt="Avatar de Usuario" /></a><br />
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 249</dd><dd><strong>Registrado:</strong> Mar Jul 14, 2009 4:13 am</dd><dd><strong>Ubicación:</strong> mexico</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5176" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5176">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5176.html#p5176"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a></strong> &raquo; Dom Mar 06, 2011 2:50 am </p>

			

			<div class="content">Genial ya logre compilarlo, ahora tengo un problema que no sé porque ocurre.<br /><br />muestro los archivos para que vean:<br /><br />// main.cpp<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>extern &quot;C&quot; {<br />&nbsp; &nbsp;#include &quot;lua5.1/lua.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lualib.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lauxlib.h&quot;<br />}<br /><br />#include &quot;example_wrap.cxx&quot;<br /><br />#include&lt;iostream&gt;<br /><br /><br /><br /><br />using namespace std;<br /><br />extern int luaopen_example(lua_State* L); // declare the wrapped module<br /><br /><br />int main(int argc,char* argv&#91;&#93;)<br />{<br />&nbsp; &nbsp;lua_State *L;<br /><br />if (argc&lt;2)<br />{<br />&nbsp; printf(&quot;%s: &lt;main.lua&gt;\n&quot;,argv&#91;0&#93;);<br />&nbsp; return 0;<br />}<br />L=lua_open();<br />luaL_openlibs(L);&nbsp; &nbsp;// load basic libs (eg. print)<br />luaopen_example(L);&nbsp; &nbsp;// load the wrappered module<br /><br />if (luaL_loadfile(L,argv&#91;1&#93;)==0) // load and run the file<br />{<br />&nbsp; &nbsp;cout&lt;&lt;&quot;Control sedido al interpreter&quot;&lt;&lt;endl;<br />&nbsp; &nbsp;lua_pcall(L,0,0,0);<br />}<br />else<br />&nbsp; printf(&quot;Error al cargar %s\n&quot;,argv&#91;1&#93;);<br />lua_close(L);<br />cout&lt;&lt;&quot;Programa terminado&quot;&lt;&lt;endl;<br />return 0;<br /> <br />&nbsp; &nbsp;<br />}<br /><br /></code></dd></dl><br /><br />// example.i<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#ifdef SWIG<br />%module example<br />%{<br />#include &quot;example.h&quot;<br />%}<br />#endif<br /><br /></code></dd></dl><br /><br />//example.h<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#ifndef EXAMPLE_H<br />#define EXAMPLE_H<br /><br /><br /><br />class motor{<br />public:<br />&nbsp; &nbsp;void iniciar();<br /><br />};<br /><br />#endif<br /></code></dd></dl><br /><br />// example.cpp<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#include &lt;iostream&gt;<br />#include &quot;example.h&quot;<br /><br />using namespace std;<br /><br /><br />void motor::iniciar(){<br />&nbsp; &nbsp; cout &lt;&lt; &quot;motor: Iniciando&quot; &lt;&lt; endl;<br />}<br /></code></dd></dl><br /><br />// main.lua (codigo a interpretar)<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>// tambien he probado con<br />// require(&quot;example&quot;)<br />// y no interpreta<br />m=example.motor();<br /><br />m:iniciar();<br /><br /></code></dd></dl><br /><br /><br />ejecuto el comando: main main.lua<br />output: <br />Control sedido al interpreter<br />Programa terminado<br /><br /><br /><br />el problema es que al llamar a m:iniciar();<br />no ejecuta nada no se porque esto ocurre.<br /><br />bueno hasta ahora agradezco su ayuda, me han aclarado bastantes cosas, <br />así que gracias y espero que me puedan ayudar nuevamente en esto.<br /><br />Saludos  <img src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			

		</div>

		
			<dl class="postprofile" id="profile5176">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 106</dd><dd><strong>Registrado:</strong> Lun Dic 13, 2010 12:23 am</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5177" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5177">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5177.html#p5177"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a></strong> &raquo; Dom Mar 06, 2011 8:45 am </p>

			

			<div class="content">Asi como tienes escrito el .lua no va a funcionar, por que tienes que incluir la biblioteca dinámica, el require es para la versión 5.1, si tienes esa y no te funcionó muestra la linea que usas para compilar. El código en lua es correcto y asi como declaraste el módulo debe tener el mismo nombre la biblioteca dinámica, seria example.so<br />y nada, cualquier duda estamos para eso.</div>

			<div id="sig5177" class="signature">El conocimiento de unos es conocimiento de todos.</div>

		</div>

		
			<dl class="postprofile" id="profile5177">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html"><img src="download/2124-avatar=2124_1283282608.jpg" width="70" height="53" alt="Avatar de Usuario" /></a><br />
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 249</dd><dd><strong>Registrado:</strong> Mar Jul 14, 2009 4:13 am</dd><dd><strong>Ubicación:</strong> mexico</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5178" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5178">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5178.html#p5178"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a></strong> &raquo; Dom Mar 06, 2011 11:04 am </p>

			

			<div class="content">Personalmente para lo que quieres hacer veo mejor que integres tu motor con lua, como hace LÖVE, y no construyas un módulo basado en tu motor para ser usado desde lua.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5178">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 38</dd><dd><strong>Registrado:</strong> Dom Oct 01, 2006 4:41 pm</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5181" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5181">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5181.html#p5181"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a></strong> &raquo; Dom Mar 06, 2011 1:04 pm </p>

			

			<div class="content">Saludos, el comando de compilacion de main.cpp que use:<br />g++ &quot;%f&quot; &quot;example.cpp&quot; -o &quot;%e&quot; -llua5.1<br /><br />tengo una pregunta, ¿como crear esa libreria example.so?.<br /><br /><blockquote><div><cite>.teri escribió:</cite>Personalmente para lo que quieres hacer veo mejor que integres tu motor con lua, como hace LÖVE, y no construyas un módulo basado en tu motor para ser usado desde lua.</div></blockquote><br /><br />hola .teri como se haria eso, integrar el motor con lua <br />si me orientaras seria genial.<br /><br /><br />Saludos y gracias por su ayuda.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5181">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2355.html">pchack</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 106</dd><dd><strong>Registrado:</strong> Lun Dic 13, 2010 12:23 am</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5182" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5182">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5182.html#p5182"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a></strong> &raquo; Dom Mar 06, 2011 5:12 pm </p>

			

			<div class="content">Para integrar tu motor con lua tienes que hacer una aplicación, con su función main y todo, y enlazarlo con la biblioteca de lua, también si tienes tu motor como una biblioteca dinámica o estática pues igualmente lo enlazas. Haces lo mismo: creas un estado de lua al principio y lo cierras al final. En un archivo o archivos aparte creas funciones de lua escritas en C que se van a encargar de comunicarse con tu motor y luego registras esas funciones en el estado de lua que hiciste.<br /><br />Puedes hacer más cosas con lua. Por ejemplo puedes hacer un archivo de configuración situado al mismo nivel que el ejecutable que puede tener por ejemplo la anchura o la altura de la ventana a crear y cambiar a tu antojo la creación de una ventana sin tener que recompilar.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5182">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 38</dd><dd><strong>Registrado:</strong> Dom Oct 01, 2006 4:41 pm</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5183" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5183">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="#p5183"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a></strong> &raquo; Dom Mar 06, 2011 7:13 pm </p>

			

			<div class="content"><blockquote><div><cite>.teri escribió:</cite>Puedes hacer más cosas con lua. Por ejemplo puedes hacer un archivo de configuración situado al mismo nivel que el ejecutable que puede tener por ejemplo la anchura o la altura de la ventana a crear y cambiar a tu antojo la creación de una ventana sin tener que recompilar.</div></blockquote><br />En el archivo lua que postee asi esta, al llamar a la función que inicializa la ventana le paso los parámetros que quiero y no tengo que recompilar, ya es cuestión de usar archivos aparte de lua para definir los parámetros del juego y cargarlos en un archivo principal.<br />En realidad no veo mucha diferencia con lo que dices a lo que pchack quiere hacer. <br /><br />Pensé que te referías a instanciar objetos en lua pero todo se ejecuta en C, de esta forma no hay que compilar de nuevo para cambiar los atributos que se le dan a las clases, pero esto ya es un poco mas complicado, pues los archivos de intercambio son mas especiales y el programador es el que los tiene que crear.<br /><br />Siguiendo con lo de pchack, me di cuenta con tu pregunta que te he llevado a un error. No es necesario incluir en main.cpp el archivo de tu juego, ese programa únicamente contiene al interprete y lo que hace es abrir un archivo para interpretar:<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>extern &quot;C&quot; {<br />&nbsp; &nbsp;#include &quot;lua5.1/lua.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lualib.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lauxlib.h&quot;<br />}<br /><br /><br />#include&lt;iostream&gt;<br /><br />using namespace std;<br /><br />int main(int argc,char* argv&#91;&#93;)<br />{<br />&nbsp; &nbsp;lua_State *L;<br /><br />if (argc&lt;2)<br />{<br />&nbsp; printf(&quot;%s: &lt;main.lua&gt;\n&quot;,argv&#91;0&#93;);<br />&nbsp; return 0;<br />}<br />L=lua_open();<br />luaL_openlibs(L);&nbsp; &nbsp;// load basic libs (eg. print)<br /><br />if (luaL_loadfile(L,argv&#91;1&#93;)==0) // load and run the file<br />{<br />&nbsp; &nbsp;cout&lt;&lt;&quot;Control sedido al interpreter&quot;&lt;&lt;endl;<br />&nbsp; &nbsp;lua_pcall(L,0,0,0);<br />}<br />else<br />&nbsp; printf(&quot;Error al cargar %s\n&quot;,argv&#91;1&#93;);<br />lua_close(L);<br />cout&lt;&lt;&quot;Programa terminado&quot;&lt;&lt;endl;<br />return 0;<br /><br />&nbsp; &nbsp;<br />}</code></dd></dl><br /><br />Así debería quedar el archivo, por otro lado tienes a example.cpp example.h y example_wrap.cxx estos son lo que vas a compilar en una biblioteca dinámica.<br /><br />g++ -I/usr/include/lua5.1 -c example_wrap.cxx -o example_wrap.o<br />g++ -c example.cpp -o example.o<br />g++ -shared -I/usr/include/lua5.1 -L/usr/lib/lua example_wrap.o example.o -o example.so<br /><br />por cierto que IDE usas, supongo que lo usas por la linea de compilación que pusiste y se me hace como al geany, no me quedó claro en que SO estás desarrollando, pero si usas Linux es mejor que uses un programa que te haga la compilación de todos los archivos, por que cuando tu código crezca vas a tener que dividirlo en una jerarquía de archivos y se puede convertir un dolor de cabeza compilarlos</div>

			<div id="sig5183" class="signature">El conocimiento de unos es conocimiento de todos.</div>

		</div>

		
			<dl class="postprofile" id="profile5183">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html"><img src="download/2124-avatar=2124_1283282608.jpg" width="70" height="53" alt="Avatar de Usuario" /></a><br />
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 249</dd><dd><strong>Registrado:</strong> Mar Jul 14, 2009 4:13 am</dd><dd><strong>Ubicación:</strong> mexico</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5184" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5184">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5184.html#p5184"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a></strong> &raquo; Dom Mar 06, 2011 11:30 pm </p>

			

			<div class="content"><blockquote class="uncited"><div>En el archivo lua que postee asi esta, al llamar a la función que inicializa la ventana le paso los parámetros que quiero y no tengo que recompilar, ya es cuestión de usar archivos aparte de lua para definir los parámetros del juego y cargarlos en un archivo principal.<br />En realidad no veo mucha diferencia con lo que dices a lo que pchack quiere hacer. <br /></div></blockquote><br /><br />Cuestión de organización. ¿Para qué crear y mantener un módulo? La misión del script es decirle al motor qué es lo que tiene que hacer, no el cómo.<br /><br />Personalmente veo mejor y más sencillo un archivo en lua, atendiendo al ejemplo de crear una ventana, que contenga estas líneas<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>Ancho = 640<br />Alto = 480<br /></code></dd></dl><br /><br />que uno que contenga esta línea<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>ventana = m:crearventana(640, 480)<br /></code></dd></dl><br /><br />El primer caso simplemente se lee el archivo, se mira si están definidas en Ancho y Alto en lua, se almacenan en dos enteros y se crean la ventana a partir de esos dos enteros, y todo esto se puede hacer desde la función principal sin muchos problemas y sin necesidad de crear un módulo, solamente el ejecutable.<br />El segundo caso, necesitas crear nada más que una función que se comunica con otra función encarga de crear una ventana y registrarlo en lua todo desde un módulo. Ok, SWIG hace eso por tí, pero para mi gusto veo el problema del mantenimiento y la organización. Más que nada a mi parecer uno no tiene control de lo que estas haciendo. Además, ¿qué necesidad tiene uno de crear varias &quot;instancias&quot; de motor cuando solamente tiene sentido que haya un solo motor? No contando además se que puede iniciar el motor sin necesidad de módulo desde un iniciar() en vez de m:iniciar(), o mejor aún, de ninguna forma.<br /><br /><blockquote class="uncited"><div>Pensé que te referías a instanciar objetos en lua pero todo se ejecuta en C, de esta forma no hay que compilar de nuevo para cambiar los atributos que se le dan a las clases, pero esto ya es un poco mas complicado, pues los archivos de intercambio son mas especiales y el programador es el que los tiene que crear.<br /></div></blockquote><br /><br />No sé si te refieres a lo que viene a continuación pero mira, me contruí un proxy de esta forma. La clase base lo uso de como &quot;base&quot; para aquellos objetos en C++ que me gustaría comunicarme desde lua. Se crea primero con lua_newuserdata el luaproxy y se le asigna el objeto. En un ejemplo asignas __newindex en una metatabla que será usada por el proxy. Y sabiendo que el primer indice es tu objeto (proxy), el 2º indice una clave (string) y el 3er indice un valor cualquiera puedes sobrecargar el método NewIndex (proxy.key = data) de tu objeto como te plaza y usarlo desde lua y tratarlo desde el método.<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code><br />class base{<br />&nbsp; &nbsp; public:<br />&nbsp; &nbsp; &nbsp; &nbsp; virtual void NewIndex(lua_State *) = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; virtual void Index(lua_State *) = 0;<br />};<br /><br />struct luaproxy{<br />&nbsp; &nbsp; base *object;<br />};<br /><br />static int __newindex(lua_State *vm){<br />&nbsp; &nbsp; //proxy, key, data<br />&nbsp; &nbsp; luaproxy *theproxy = lua_touserdata(vm, 1);<br />&nbsp; &nbsp; theproxy-&gt;object-&gt;NewIndex(vm);<br />&nbsp; &nbsp; return 0;<br />}<br /><br />static int __index(lua_State *vm){<br />&nbsp; &nbsp; //proxy, key<br />&nbsp; &nbsp; luaproxy *theproxy = lua_touserdata(vm, 1);<br />&nbsp; &nbsp; theproxy-&gt;object-&gt;Index(vm);<br />&nbsp; &nbsp; return 1;<br />}<br /><br /></code></dd></dl><br /><br />Algo más avanzado, con esto y una función lua escrita en C/C++ puedes aprovechar el recolector de basura de lua para crear objetos de c++ desde lua y sobrecargando __gc puedes borrar la instancia de la clase cuando el recolector de basura lo vaya a borrar.<br /><br />Otra cosa, puedes sustituir esto<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>extern &quot;C&quot; {<br />&nbsp; &nbsp;#include &quot;lua5.1/lua.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lualib.h&quot;<br />&nbsp; &nbsp;#include &quot;lua5.1/lauxlib.h&quot;<br />}<br /></code></dd></dl><br />por esto<br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>#include &lt;lua5.1/lua.hpp&gt;<br /></code></dd></dl></div>

			

		</div>

		
			<dl class="postprofile" id="profile5184">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 38</dd><dd><strong>Registrado:</strong> Dom Oct 01, 2006 4:41 pm</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5185" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5185">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5185.html#p5185"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a></strong> &raquo; Lun Mar 07, 2011 12:30 am </p>

			

			<div class="content"><blockquote><div><cite>.teri escribió:</cite>SWIG hace eso por tí, pero para mi gusto veo el problema del mantenimiento y la organización. Más que nada a mi parecer uno no tiene control de lo que estas haciendo. Además, ¿qué necesidad tiene uno de crear varias &quot;instancias&quot; de motor cuando solamente tiene sentido que haya un solo motor? No contando además se que puede iniciar el motor sin necesidad de módulo desde un iniciar() en vez de m:iniciar(), o mejor aún, de ninguna forma.</div></blockquote><br /><br />Hacer las declaraciones de lo que quieres exportar a lua es como hacer un makefile de un proyecto de 100 fuentes a mano, para eso existe swig, realiza las llamadas a la biblioteca de lua para poder ser llamadas desde el interprete.<br />Lo que dices de llamar a funciones como iniciar(), ya sería mas propio del lenguaje. Por ejemplo pilas usa pysfml la cual no está escrita en python (que yo sepa) de cualquier forma muchas funciones en python son llamadas de bibliotecas dinámicas escritas en C/C++ es lo mismo que se hace con lua, solo que tu escribes esos módulos.<br />Que es mejor si iniciar() o m:iniciar(), es subjetivo, sobretodo si es un motor para un juego específico, aprendi esto de lua por que también escribí un motor la forma en la que se hacen las llamadas desde lua al motor asustaría a muchos, por que es ineficiente. Me gusta mas la forma es que lo hace pilas, que es trabajar con las instancias de objetos en el motor, lo cual se puede hacer con lua. Como dices es cuestión de organización y la forma de estructurar el interprete, en este caso y en el mio, usamos lua como un guion que indica como se desarrolla el juego, lo bueno de ser interpretado es que se puede cambiar el guión y hacer un juego diferente, ese es el principal principio que seguí, lo demás son cosas técnicas. <br />Por cierto, si tienes ejemplos de lo que hayas hecho con lua pasalos no?</div>

			<div id="sig5185" class="signature">El conocimiento de unos es conocimiento de todos.</div>

		</div>

		
			<dl class="postprofile" id="profile5185">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html"><img src="download/2124-avatar=2124_1283282608.jpg" width="70" height="53" alt="Avatar de Usuario" /></a><br />
				<a href="memberlist.php-mode=viewprofile&amp;u=2124.html" style="color: #00AA00;" class="username-coloured">carlostex</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 249</dd><dd><strong>Registrado:</strong> Mar Jul 14, 2009 4:13 am</dd><dd><strong>Ubicación:</strong> mexico</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5186" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p5186">Re: C++ y Lua para videojuegos</a></h3>
			<p class="author"><a href="viewtopic.php-p=5186.html#p5186"><img src="styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Nota" title="Nota" /></a>por <strong><a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a></strong> &raquo; Lun Mar 07, 2011 11:10 am </p>

			

			<div class="content"><blockquote class="uncited"><div>Hacer las declaraciones de lo que quieres exportar a lua es como hacer un makefile de un proyecto de 100 fuentes a mano, para eso existe swig, realiza las llamadas a la biblioteca de lua para poder ser llamadas desde el interprete.<br /></div></blockquote><br /><br />Depende qué estas exportando exactamente o si es lo más adecuado o no. Lua también lo uso para escribir código de alto nivel, no funciones o métodos individualizados, aparte de usarlo como lenguaje de descripción. Personalmente veo que si uno llega a decir eso (lo de <span style="font-weight: bold">escribió</span>), entonces deberías pensar seriamente el diseño o la solución porque seguramente estas haciendo algo mal.<br /><br /><blockquote class="uncited"><div>Por cierto, si tienes ejemplos de lo que hayas hecho con lua pasalos no?<br /></div></blockquote><br /><br />Bueno, jamás pensé que llegaría a escribir esto, y no sé si es lo más adecuado como para ejemplo. Estuve haciendo un proyecto, funcional, pero no terminado de algo parecido a LÖVE pero de muy alto nivel, gran ejemplo de lo que estaba haciendo, y en el que tan solo tienes que escribir qué es lo que vas a hacer.<br /><br /><!-- m --><a class="postlink" href="http://code.google.com/p/bangameengine/">http://code.google.com/p/bangameengine/</a><!-- m --><br /><br />Por ejemplo, si quieres escribir &quot;hola mundo&quot; por pantalla, nada más desde un archivo lua tienes que escribir<br /><br /><dl class="codebox"><dt>Código: <a href="#" onclick="selectCode(this); return false;">Seleccionar todo</a></dt><dd><code>bange.SetBgColor(50, 50, 50)<br /><br />scene = bange.NewScene(1)<br />view = bange.NewView()<br /><br />view.scene = scene<br /><br />scene:SetLayer(1, LayerObject)<br />string = scene&#91;1&#93;:AddSimpleString(&quot;Hello world!&quot;)<br /><br />bange.Run = {views = {view}}<br /><br /></code></dd></dl><br /><br />No, lo de &quot;bange&quot; no es un objeto, es una tabla donde he almacenado todas las funciones, que son pocas y las justas, para comunicarse con el motor, algo así como un namespace de C++. Si ves las distintas clases como scene o layer, verás como se propaga los métodos NewIndex o Index por las clases padres o hermanas. Si te descargas el proyecto desde mercurial (que es de la única forma), verás el ejemplo en un archivo 7z, que puedes llamar escribiendo &quot;bange helloworld.7z&quot;. Dentro del paquete verás config.lua donde está la configuración de la ventana, y run.lua que es el código escrito aquí. Mira sobre todo el módulo <a href="http://code.google.com/p/bangameengine/source/browse/src/bange_base.cpp" class="postlink">base</a> del proyecto, porque ahí es donde está todo el meollo.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5186">
			<dt>
				<a href="memberlist.php-mode=viewprofile&amp;u=34.html">.teri</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Mensajes:</strong> 38</dd><dd><strong>Registrado:</strong> Dom Oct 01, 2006 4:41 pm</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Arriba">Arriba</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="viewtopic.php-f=8&amp;t=1068&amp;start=0.html">

	<fieldset class="display-options" style="margin-top: 0; ">
		
		<label>Mostrar mensajes previos: <select name="st" id="st"><option value="0" selected="selected">Todos los mensajes</option><option value="1">1 día</option><option value="7">7 días</option><option value="14">2 semanas</option><option value="30">1 mes</option><option value="90">3 meses</option><option value="180">6 meses</option><option value="365">1 año</option></select></label>
		<label>Ordenar por <select name="sk" id="sk"><option value="a">Autor</option><option value="t" selected="selected">Fecha publicación</option><option value="s">Asunto</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascendente</option><option value="d">Descendente</option></select> <input type="submit" name="sort" value="Ir" class="button2" /></label>
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
		<div class="reply-icon"><a href="posting.php-mode=reply&amp;f=8&amp;t=1068.html" title="Publicar una respuesta"><span></span>Publicar una respuesta</a></div>
	
	</div>

	
		<div class="pagination">
			14 mensajes
			 &bull; Página <strong>1</strong> de <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="viewforum.php-f=8.html" class="left-box left" accesskey="r">Volver a Sobre lenguajes de programación</a></p>

	<form method="post" id="jumpbox" action="viewforum.php.html" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Saltar a:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Seleccione un Foro</option>
			<option value="-1">------------------</option>
				<option value="15">Proyecto Losersjuegos</option>
			
				<option value="1">&nbsp; &nbsp;Planificación y eventos</option>
			
				<option value="14">&nbsp; &nbsp;Asadetris</option>
			
				<option value="22">Pilas Engine</option>
			
				<option value="23">&nbsp; &nbsp;Anuncios de los desarrolladores</option>
			
				<option value="24">&nbsp; &nbsp;Consultas, problemas o bugs.</option>
			
				<option value="25">&nbsp; &nbsp;Proyectos usando pilas</option>
			
				<option value="26">&nbsp; &nbsp;Sugerencias e ideas</option>
			
				<option value="28">&nbsp; &nbsp;General</option>
			
				<option value="16">Sugerencias, proyectos e ideas</option>
			
				<option value="2">&nbsp; &nbsp;Artículos, traducciones y documentación</option>
			
				<option value="3">&nbsp; &nbsp;Ejemplos</option>
			
				<option value="4">&nbsp; &nbsp;Videojuegos</option>
			
				<option value="12">&nbsp; &nbsp;Propuestas de desarrollo y concursos</option>
			
				<option value="13">&nbsp; &nbsp;Inspiración y otras ideas interesantes</option>
			
				<option value="5">&nbsp; &nbsp;Otros</option>
			
				<option value="17">Consultas</option>
			
				<option value="6">&nbsp; &nbsp;Sobre las bibliotecas multimedia</option>
			
				<option value="7">&nbsp; &nbsp;Instalación de bibliotecas y herramientas</option>
			
				<option value="8" selected="selected">&nbsp; &nbsp;Sobre lenguajes de programación</option>
			
				<option value="9">&nbsp; &nbsp;General</option>
			
				<option value="20">&nbsp; &nbsp;3D</option>
			
				<option value="29">&nbsp; &nbsp;HTML5 y Javascript</option>
			
				<option value="30">&nbsp; &nbsp;Qt y pyqt</option>
			
				<option value="18">Otros</option>
			
				<option value="10">&nbsp; &nbsp;Fuera de tópico</option>
			
				<option value="11">&nbsp; &nbsp;Links interesantes</option>
			
			</select>
			<input type="submit" value="Ir" class="button2" />
		</fieldset>
	</form>


	<h3>¿Quién está conectado?</h3>
	<p>Usuarios navegando por este Foro: No hay usuarios registrados visitando el Foro y 0 invitados</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="index.php.html" accesskey="h">Índice general</a></li>
				
			<li class="rightside"><a href="memberlist.php-mode=leaders.html">El Equipo</a> &bull; <a href="ucp.php-mode=delete_cookies.html">Borrar todas las cookies del Sitio</a> &bull; Todos los horarios son UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>



<div id="pie">

    <ul>
            <li class="contactenos"><a href="../comunidad/contactenos.html">Contáctenos</a></li>
                
                <li class="cc"><a href="http://creativecommons.org/licenses/by-sa/2.5/deed.es">Licencia de uso para el sitio</a></li>

                    <li class="foro"><a href="index.html">Foro de mensajes</a></li>

                        <li class="comunidad"><a href="../comunidad.html">Sobre el grupo ...</a></li>
                    </ul>
                </div>


</div> <!-- borde -->
</div>


<div class="copyright">
Este foro de mensajes funciona gracias al sistema <a href="http://www.phpbb.com/">phpBB</a>
<br/>
Tema visual personalizando por Hugo Ruscitti.
<br/>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	<img src="cron.php-cron_type=tidy_cache.gif" width="1" height="1" alt="cron" />
</div>

</body>
</html>