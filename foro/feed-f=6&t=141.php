<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="es">
<link rel="self" type="application/atom+xml" href="http://losersjuegos.com.ar/foro/feed.php?f=6&amp;t=141" />

<title>LosersJuegos</title>
<subtitle>Desarrollando videojuegos libres</subtitle>
<link href="http://losersjuegos.com.ar/foro/index.php" />
<updated>2007-08-14T08:13:31+00:00</updated>

<author><name><![CDATA[LosersJuegos]]></name></author>
<id>http://losersjuegos.com.ar/foro/feed.php?f=6&amp;t=141</id>
<entry>
<author><name><![CDATA[delaPipol]]></name></author>
<updated>2007-08-14T08:13:31+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=481#p481</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=481#p481"/>
<title type="html"><![CDATA[SDL - Trabajar con transparencias por índice de paleta]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=481#p481"><![CDATA[
Impresionante, era exactamente lo que decía Hugo <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />. He probado el código y funciona a la perfección. Sobre el color que se comenta en los comentarios de sumar y restar 1 en vez de 8 al color azul a 32 bits funciona, tal y como se sospechaba. Parece que a 16 bits hace la distinción de colores cada 4 tonos (edito: según cierta documentación sigue el esquema RGB565) y por tanto el incremento o decremento de 8 lo hace seguro <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />. En el código creaba una surface de 8 bits de profundidad donde trabajar luego con la surface de la imagen y tampoco hubo ningún problema. Quien quiera ojear el resultado que acceda por Subversion a <!-- m --><a class="postlink" href="http://easyrpg.svn.sourceforge.net/viewvc/easyrpg/trunk/player/">http://easyrpg.svn.sourceforge.net/view ... nk/player/</a><!-- m --> (este es el enlace a la interfaz web viewc)<br /><br /><blockquote><div><cite>rcaf escribió:</cite><br />Creo que la solución para estos típicos problemas es que todas las imágenes que van a formar una escena, compartan la misma paleta de colores.<br /></div></blockquote>Así es, con tener la paleta en condiciones con un colorkey común se solucionaría sin tanta complicación, pero como dije el problema es que se intenta simular otro sistema existente donde las imágenes ya vienen creadas. De hecho esta parte del proyecto intenta ser una especie de &quot;emulador&quot; como ScummVM pero en este caso de juegos creados con RPG Maker 2000 y por ello la necesidad explícita de adaptarse a sus peculiaridades.<br /><br /><blockquote><div><cite>Geo escribió:</cite><br />No he revisado la propuesta de Hugo (que me parece da muy buen resultado), lo otro que se me ocurre es, reescribir la función SDL_Blit para el caso de superficies de 8 bits, de manera que tome la transparencia del primer índice en la paleta y no de la estructura SDL_BlitInfo.<br /></div></blockquote>Más adelante se podría reabrir el <a href="http://www.easy-rpg.com/bugs/index.php?do=details&amp;task_id=1" class="postlink">bug</a> para hacer más eficiente la asignación de la transparencia, de todas formas se podría mandar un parche (es que yo ya me traumé de darle tantas vueltas al mismo bug <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> y me gustaría centrarme en avanzar la lectura de los mapeados para darle vitalidad al proyecto).<br /><img src="http://img183.imageshack.us/img183/4360/downloadyu1.png" alt="Imagen" /><br /><blockquote><div><cite>Geo escribió:</cite><br />Por cierto delaPipol, ¡ánimo con ese proyecto <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_smile.gif" alt=":)" title="Smile" />! Ojalá pueda participar de alguna forma, lamentablemente estoy ahorcado de tiempo para escribir código <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_razz.gif" alt=":P" title="Razz" />.<br /></div></blockquote>Muchísimas gracias <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />, ya sabes que cuando quieras tener escritura en svn en el proyecto hazlo saber <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_wink.gif" alt=";)" title="Wink" />. Muchas personas que se interesaron por RPG Maker en el pasado ahora lo han hecho con la programación, y la estrategia de este proyecto es poder atraer más &quot;cantera&quot; de talentos al mundo del software libre, donde podrían portar sus proyectos a más sistemas y plataformas <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_wink.gif" alt=":wink:" title="Wink" />.<br /><br /><br />Pues muchísimas gracias Hugo por una explicación tan clara y didáctica, ojalá resulte útil a muchas más personas esta solución. Ya conseguí anteriormente por mi cuenta hacer la primera parte, pero luego ni me imaginaría que a 16 bit daría problemas sumándole tan solo 1 luego. Agradezco enormemente el apoyo, espero estar al nivel de poder responder cuestiones por esta comunidad. ¡Saludos! <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_wink.gif" alt=";)" title="Wink" /><p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=1794">delaPipol</a> — Mar Ago 14, 2007 8:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Geo]]></name></author>
<updated>2007-08-08T22:18:29+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=475#p475</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=475#p475"/>
<title type="html"><![CDATA[SDL - Trabajar con transparencias por índice de paleta]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=475#p475"><![CDATA[
No he revisado la propuesta de Hugo (que me parece da muy buen resultado), lo otro que se me ocurre es, reescribir la función SDL_Blit para el caso de superficies de 8 bits, de manera que tome la transparencia del primer índice en la paleta y no de la estructura SDL_BlitInfo.<br /><br />No estoy seguro, pero me parece que el código se encuentra en el archivo <span style="font-weight: bold">SDL_blit_0.c</span>, en la función <span style="font-weight: bold">BlitBto1Key</span><br /><br />En lugar de esto:<br /><dl class="codebox"><dt>Code: </dt><dd><code>static void BlitBto1Key&#40;SDL_BlitInfo *info&#41; &#123;<br />// ...<br />  Uint32 ckey = info-&gt;src-&gt;colorkey;<br />// ...<br />  Uint8 *palmap = info-&gt;table;<br />// ...<br />&#125;<br /></code></dd></dl><br />algo como esto:<br /><dl class="codebox"><dt>Code: </dt><dd><code>static void BlitBto1Key&#40;SDL_BlitInfo *info&#41; &#123;<br />// ...<br />  Uint8 *palmap = info-&gt;table;<br />  Uint32 ckey = palmap&#91; 0 &#93;;<br />  // o por si alguien se queja de pasar un Uint8 a un Uint32 :P<br />  // Uint32 ckey = 0x000f &amp; palmap&#91; 0 &#93;;<br />// ...<br />&#125;<br /></code></dd></dl><br />---------------------<br />Edit:<br />nop, no sería así, sería modificar esta parte de la misma función:<br /><dl class="codebox"><dt>Code: </dt><dd><code>if &#40; palmap &#41; &#123;<br />      while &#40; height-- &#41; &#123;<br />              Uint8  byte = 0, bit;<br />             for &#40; c=0; c&lt;width; ++c &#41; &#123;<br />            if &#40; &#40;c&amp;7&#41; == 0 &#41; &#123;<br />               byte = *src++;<br />            &#125;<br />            bit = &#40;byte&amp;0x80&#41;&gt;&gt;7;<br />            if &#40; bit != ckey &#41; &#123;<br />              *dst = palmap&#91;bit&#93;;<br />            &#125;<br />            dst++;<br />            byte &lt;&lt;= 1;<br />         &#125;<br />         src += srcskip;<br />         dst += dstskip;<br />      &#125;<br /></code></dd></dl><br /><br />Por cierto delaPipol, ¡ánimo con ese proyecto <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_smile.gif" alt=":)" title="Smile" />! Ojalá pueda participar de alguna forma, lamentablemente estoy ahorcado de tiempo para escribir código <img src="http://losersjuegos.com.ar/foro/images/smilies/icon_razz.gif" alt=":P" title="Razz" />.<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=6">Geo</a> — Mié Ago 08, 2007 10:18 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[hugoruscitti]]></name></author>
<updated>2007-08-08T17:43:02+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=473#p473</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=473#p473"/>
<title type="html"><![CDATA[¿posible solución?]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=473#p473"><![CDATA[
Hola Fran, la verdad es que nunca me encontré ante un problema similar y<br />por ello intenté &quot;reconstruir&quot; el problema que tienes e intenté buscarle una<br />solución (y creo que la encontré).<br /><br />En el siguiente archivo están las pruebas que realicé:<br />    <br />    <a href="http://www.losersjuegos.com.ar/incoming/descargas/20070808/transparencias_8bits.tar.gz" class="postlink">http://www.losersjuegos.com.ar/incoming/descargas/20070808/transparencias_8bits.tar.gz</a><br /><br />Cuando extraigas el contenido del archivo encontrarás dos directorios, uno se<br />llama &quot;problema&quot;, en donde se almacena una imagen que tiene el problema que nos<br />indicas, a saber:<br /><br />La imagen original se encuentra en 8 bits, por lo tanto cada &quot;pixel&quot; de la<br />imagen es, en realidad, un número que identifica la tonalidad de color de ese<br />pixel. Esta imagen almacena una paleta de colores también.<br /><br />El problema de este ejemplo llega al querer indicarle a SDL que nuestro color de<br />transparencia será el color de índice 0 en la paleta. SDL nos permite definir el<br />color de transparencia mediante la función SDL_SetColorKey, aunque esta función<br />admite como parámetros las componentes del color que buscamos &quot;hacer<br />transparente&quot;, en lugar de su posición el la paleta de colores.<br /><br />Lamentablemente, esta imagen que he utilizado como prueba, tiene repetidos<br />algunos colores:<br /><br />    <img src="http://www.losersjuegos.com.ar/incoming/descargas/20070808/diagrama_problema.png" alt="Imagen" /><br /><br />el color de índice 0 en la paleta es idéntico al color ubicado en la posición<br />63, 64. Todos estos colores tienen las componentes (r=255, g=255, b=255), por lo<br />tanto si construyes una rutina como la siguiente, buscando definir como<br />&quot;transparente&quot; el color de índice 0:<br />    <br /><dl class="codebox"><dt>Code: </dt><dd><code>indice_0 = tmp-&gt;format-&gt;palette-&gt;colors&#91;0&#93;;<br />colorkey = SDL_MapRGB&#40;ima-&gt;format, indice_0.r, indice_0.g, indice_0.b&#41;;</code></dd></dl><br /><br />SDL hará transparentes todos los píxeles cuyas componentes sean idénticas al<br />color de índice 0 de tu paleta. Para este ejemplo, obtendrías algo como lo<br />siguiente:<br /><br /><img src="http://www.losersjuegos.com.ar/incoming/descargas/20070808/problema.png" alt="Imagen" /><br /><br /><br />he buscado en la documentación de SDL y no encontré una función similar a<br />SDL_SetColorKey para imágenes de 8 bits, tal vez exista, pero no la he<br />encontrado. En su lugar escribí una rutina que podría servirte para adaptar<br />estas imágenes al juego y poder asignarles un color de transparencia, siguiendo<br />los procedimientos que nos indicas en tu primer mensajes, es decir, alterar<br />aquellos colores que tiene la mismas componentes de color que el color 0 de la<br />paleta. <br /><br />Encontrarás esta rutina de código en el directorio &quot;posible_solucion&quot; del <br />archivo que cité anteriormente.<br /><br />Y en pantalla quedaría de la siguiente manera:<br />    <br />    <img src="http://www.losersjuegos.com.ar/incoming/descargas/20070808/posible_solucion.png" alt="Imagen" /><br /><br />Saludos y buena suerte con el juego.<br /><br />edito: utilicé incorrectamente la etiqueta &quot;code&quot; en la primer <br />publicación...<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=3">hugoruscitti</a> — Mié Ago 08, 2007 5:43 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[rcaf]]></name></author>
<updated>2007-08-07T20:18:17+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=469#p469</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=469#p469"/>
<title type="html"><![CDATA[SDL - Trabajar con transparencias por índice de paleta]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=469#p469"><![CDATA[
Hola:<br /><br />Hace varios años atrás trabaje con modos de video a 8 Bits por Pixel, en Allegro y SDL. <br /><br />Creo que la solución  para estos típicos problemas es que todas las imágenes que van a formar una escena, compartan la misma paleta de colores. <br /><br />Solía copiar el fondo y todas los imágenes que usaría en una escena en una imagen nueva con formato RGB (con un tamaño adecuado para que cupieran todas). Luego cuando ya tenía todas las imágenes listas le cambiaba el formato a la imagen a modo indexado (8 bits). <br /><br />En aquellos años ocupé Paint Shop Pro para hacer esta tarea, y también para obtener la paleta de colores en un archivo separado.<br /><br />Espero que este método te ayude a solucionar tus problemas. Creo que es mejor que estar haciendo códigos extraños para arreglar los colores.<br /><br />Saludos!<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=8">rcaf</a> — Mar Ago 07, 2007 8:18 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[delaPipol]]></name></author>
<updated>2007-08-07T13:03:49+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=467#p467</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=467#p467"/>
<title type="html"><![CDATA[SDL - Trabajar con transparencias por índice de paleta]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=141&amp;p=467#p467"><![CDATA[
Hola, que tal! Me llamo Fran y estaba aprendiendo un poco de SDL para un proyecto libre recientemente comenzado. El proyecto se basa en simular el funcionamiento de otro y por ello requiere algunos aspectos un tanto extravagantes como el siguiente, que no sé si alguien se lo habrá encontrado en alguna ocasión:<br /><br />A la hora de trabajar con sprites en este proyecto se necesita tratar con imágenes de 8 bit, por tanto utiliza un bloque de paleta y luego un bloque de mapa de bits haciendo referencia a esos valores del índice de paleta (a diferencia de las de color verdadero, que no tienen esa paleta sino que en el propio mapa de bits se define el valor de color por cada &quot;píxel&quot;).<br /><br />Así pues, en este caso el formato de píxel es de 8 bit y se puede tratar con la paleta. El problema viene con la transparencia. SDL trata la transparencia por un valor de color (ColorKey) y los archivos de sprite que necesitan leerse tienen definida la transparencia por el índice de paleta.<br /><br />En principio con leer el valor de color de ese índice 0 sería suficiente, con algo así como surface-&gt;format-&gt;palette-&gt;colors[0] si no me equivoco.<br /><br />El problema viene cuando en esa misma paleta encuentras que por ejemplo el color número 0 de la paleta que será el transparente vale 255,0,255 y el número 43 y el 129 (por decir algunos) también tienen como valor 255,0,255. Eso supone que esos colores también se vean transparentes, por las características del propio SDL.<br /><br />La solución al problema de colores duplicados sería aplicar por ejemplo sumarle +1 al componente azul, que es el que menos diferencia percibirán nuestros ojos surface-&gt;format-&gt;palette-&gt;colors[43].b + 1 y si ya vale 255 como en este ejemplo entonces - 1 (quedando 255,0,254). Todo ello se podría meter en un for para que recorriera la paleta entera comparando si el valor RGB del índice 0 coincide con el resto de los 256 colores.<br /><br />¿Alguien se ha encontrado con este caso? He mirado en listas de correo y demás y no he encontrado ninguna situación similar.<br /><br />Un saludo y suerte!<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=1794">delaPipol</a> — Mar Ago 07, 2007 1:03 pm</p><hr />
]]></content>
</entry>
</feed>