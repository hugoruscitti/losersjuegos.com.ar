<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="es">
<link rel="self" type="application/atom+xml" href="http://losersjuegos.com.ar/foro/feed.php?f=6&amp;t=641" />

<title>LosersJuegos</title>
<subtitle>Desarrollando videojuegos libres</subtitle>
<link href="http://losersjuegos.com.ar/foro/index.php" />
<updated>2009-10-26T09:12:11+00:00</updated>

<author><name><![CDATA[LosersJuegos]]></name></author>
<id>http://losersjuegos.com.ar/foro/feed.php?f=6&amp;t=641</id>
<entry>
<author><name><![CDATA[endaramiz]]></name></author>
<updated>2009-10-26T09:12:11+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=641&amp;p=3007#p3007</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=641&amp;p=3007#p3007"/>
<title type="html"><![CDATA[Problema con RotoZoom]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=641&amp;p=3007#p3007"><![CDATA[
Bienvenido, en fuera de tópico hay un tema donde puedes hablar un poco sobre ti.<br /><br />No sé el fallo concreto ya que no tengo todo el código. Pero diría que estás tratando posx y posy como la esquina superior izquierda de la imagen. Quizás se resuelva si tratas a posx y posy como centros y luego a la hora de hacer el blit, ya se calcula donde está la esquina superior izquierda.<br /><dl class="codebox"><dt>Code: </dt><dd><code>SDL_Rect dst = &#123;posx - ImagenRotada-&gt;w/2, posy - ImagenRotada-&gt;h/2&#125;;<br />SDL_BlitSurface&#40;ImagenRotada, NULL, screen, &amp;dst&#41;;</code></dd></dl><br /><br />Saludos.<p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=1809">endaramiz</a> — Lun Oct 26, 2009 9:12 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Metalero]]></name></author>
<updated>2009-10-24T16:09:05+00:00</updated>
<id>http://losersjuegos.com.ar/foro/viewtopic.php?t=641&amp;p=3005#p3005</id>
<link href="http://losersjuegos.com.ar/foro/viewtopic.php?t=641&amp;p=3005#p3005"/>
<title type="html"><![CDATA[Problema con RotoZoom]]></title>

<content type="html" xml:base="http://losersjuegos.com.ar/foro/viewtopic.php?t=641&amp;p=3005#p3005"><![CDATA[
Bueno, antes que anda me presento ante la comunidad (no encontre una seccion para presentarme), me llamo Juan, soy argentino, y hace varios años empece que esto del desarrollo de videojuegos (usando el Game Engine RPG Maker XP) y hace un tiempo me meti con SDL.<br /><br />La cuestion es la siguiente, estoy intentando crear una serie de librerias multimedia (en base a un rejunte de cosas) para poder trabjar mas facil (metiendo todo lo relacionado a bajo nivel en las librerias)<br /><br />La cuestion es que llegue a la parte que necesito poder rotar imagenes, hasta ahi bien, encontre la libreria RotoZoom, estuve viendo todas las funciones, y me puse a implementarla en mi libreria.<br /><br />La idea es hacer una funcion asi:<br /><br /><dl class="codebox"><dt>Code: </dt><dd><code>nave.angle&#40;int angulo,int smooth&#41;;</code></dd></dl><br /><br />Donde nave es un SDL_Surface con un grafico cargado, angulo es el angulo de rotacion y smooth es un flag para activar y desctivar el antialias.<br /><br />La funcion es asi:<br /><br /><dl class="codebox"><dt>Code: </dt><dd><code>void CSprite::angle&#40;int angulo, int s&#41;&#123;<br />  sprite&#91;estado&#93;.img = rotozoomSurface&#40;sprite_est&#91;estado&#93;.img, angulo, 1, smooth&#41;&#123;<br />  posx -= &#40;sprite&#91;estado&#93;.img-&gt;w - sprite_est&#91;estado&#93;.img-&gt;w&#41; / 2;<br />  posy -= &#40;sprite&#91;estado&#93;.img-&gt;h - sprite_est&#91;estado&#93;.img-&gt;h&#41; / 2; <br />&#125;<br /></code></dd></dl><br /><br />sprite y sprite_est es uin array de surfaces con imagenes (img es el bitmap de la surface)<br /><br />srpite es la imagen que se muestra en pantalla, mientras que espite_est, es la imagen cargada original, que no se altera en ningun momento.<br /><br />El problema que tengo es que cuando roto la imagen, hace es movimiento de rebote (que deberia solucionarse con las correcciones:<br /><br /><br /><dl class="codebox"><dt>Code: </dt><dd><code>posx -= &#40;sprite&#91;estado&#93;.img-&gt;w - sprite_est&#91;estado&#93;.img-&gt;w&#41; / 2;<br />posy -= &#40;sprite&#91;estado&#93;.img-&gt;h - sprite_est&#91;estado&#93;.img-&gt;h&#41; / 2; <br /></code></dd></dl><br /><br />Pero sigue sin funcionar.<br /><br />Aca les dejo es codigo entero que esoty usando:<br /><br /><dl class="codebox"><dt>Code: </dt><dd><code>#include &lt;stdio&gt;<br />#include &lt;stdlib&gt;<br />#include &lt;SDL&gt;<br />#include &lt;SDL&gt;<br />#include &quot;include/graphics.h&quot;<br /><br /><br />SDL_Surface *screen;<br />CFrame fnave;<br />CFrame fmalo;<br />CSprite nave&#40;1&#41;;<br />CSprite malo&#40;1&#41;;<br />SDL_Rect rectangulo;<br />SDL_Joystick *joystick;<br />int joyx, joyy;<br />int done=0;<br />int player_rects &#91;4&#93;&#91;4&#93; = &#123;&#123;48,0,13,33&#125;, <br />                           &#123;39,33,31,111&#125;,<br />                           &#123;0,78,40,46&#125;, <br />                           &#123;70,78,40,46&#125;<br />                          &#125;;<br />                          <br /><br />Uint32 ini_milisegundos, fin_milisegundos, frametime;<br />int angulo = 0;<br /><br />// estructura que contiene la información de la imagen<br />struct minave &#123;<br />  int x,y;<br />&#125; jugador;<br /><br /><br />// Dibuja los esprites en la pantalla<br />void DrawScene&#40;SDL_Surface *screen&#41; &#123;<br />  // borramos en el frame anterior<br />  rectangulo.x=nave.getx&#40;&#41;;<br />  rectangulo.y=nave.gety&#40;&#41;;<br />  rectangulo.w=nave.getw&#40;&#41;;<br />  rectangulo.h=nave.geth&#40;&#41;;<br />  SDL_FillRect&#40;screen,&amp;rectangulo,SDL_MapRGB&#40;screen-&gt;format,0,0,0&#41;&#41;;<br />   <br />   // dibuja avión<br />  nave.setx&#40;jugador.x&#41;;<br />  nave.sety&#40;jugador.y&#41;;<br />  nave.draw&#40;screen&#41;;<br />  // Mostramos todo el frame<br />  SDL_Flip&#40;screen&#41;;<br />&#125;<br /><br />// Inicializamos estados<br />void inicializa&#40;&#41; &#123;<br />  jugador.x=150;<br />  jugador.y=150;<br />  <br />  nave.set_rects&#40;player_rects&#41;;<br /><br />&#125;<br /><br />void finaliza&#40;&#41; &#123;<br />  // finalizamos los sprites<br />  nave.dispose&#40;&#41;;<br />  // cerramos el joystick<br />  if &#40;SDL_JoystickOpened&#40;0&#41;&#41; &#123;<br />    SDL_JoystickClose&#40;joystick&#41;;<br />  &#125;<br />&#125;<br /><br />// Preparamos los esprites<br />int InitSprites&#40;&#41; &#123;<br />  fnave.load&#40;&quot;Imagen.png&quot;&#41;;<br />  nave.addframe&#40;fnave&#41;;<br />  return 0;<br />&#125;<br /><br />void ResetTimeBase&#40;&#41; &#123;<br />  ini_milisegundos=SDL_GetTicks&#40;&#41;;<br />&#125;<br /><br />int CurrentTime&#40;&#41; &#123;<br />  fin_milisegundos=SDL_GetTicks&#40;&#41;;<br />  return fin_milisegundos-ini_milisegundos;<br />&#125;<br /><br />int main&#40;int argc, char *argv&#91;&#93;&#41; &#123;<br />  SDL_Event event;<br />  Uint8 *keys;<br />  if &#40;SDL_Init&#40;SDL_INIT_VIDEO|SDL_INIT_JOYSTICK|SDL_INIT_AUDIO&#41; &lt; 0&#41; &#123;<br />    printf&#40;&quot;No se pudo iniciar SDL: %s\n&quot;,SDL_GetError&#40;&#41;&#41;;<br />    return 1;<br />  &#125;<br />  screen = SDL_SetVideoMode&#40;640,480,24,SDL_HWSURFACE&#41;;<br />  if &#40;screen == NULL&#41; &#123;<br />    printf&#40;&quot;No se puede inicializar el modo gráfico: \n&quot;,SDL_GetError&#40;&#41;&#41;;<br />    return 1;<br />  &#125;<br />  atexit&#40;SDL_Quit&#41;;<br />  <br />  InitSprites&#40;&#41;;<br />  inicializa&#40;&#41;;<br />  while &#40;done == 0&#41; &#123;<br />    ResetTimeBase&#40;&#41;;<br />    // dibujamos el frame<br />    DrawScene&#40;screen&#41;;<br />    // consultamos el estado del teclado<br />    keys=SDL_GetKeyState&#40;NULL&#41;;<br />    // consultamos el estado del joystick<br />    SDL_JoystickUpdate&#40;&#41;;<br />    joyx = SDL_JoystickGetAxis&#40;joystick, 0&#41;;<br />    joyy = SDL_JoystickGetAxis&#40;joystick, 1&#41;;<br />    if &#40;&#40;keys&#91;SDLK_UP&#93; || joyy &lt;10&gt; 0&#41;&#41; &#123;<br />    &#125;<br />    if &#40;&#40;keys&#91;SDLK_DOWN&#93; || joyy &gt; 10&#41; &amp;&amp; &#40;jugador.y &lt; 460&#41;&#41; &#123;<br />    &#125;<br />    if &#40;&#40;keys&#91;SDLK_LEFT&#93; || joyx &lt;10&gt; 0&#41;&#41; &#123;<br />        angulo += 2;<br />        nave.angle&#40;angulo,1&#41;;<br />    &#125;<br />    if &#40;&#40;keys&#91;SDLK_RIGHT&#93; || joyx &gt; 10&#41; &amp;&amp; &#40;jugador.x &lt; 620&#41;&#41; &#123;<br />      angulo -= 2;<br />      nave.angle&#40;angulo,1&#41;;<br />    &#125;<br />    while &#40;SDL_PollEvent&#40;&amp;event&#41;&#41; &#123;<br />      if &#40;event.type == SDL_QUIT&#41; &#123;done=1;&#125;<br />      if &#40;event.type == SDL_KEYDOWN || event.type == SDL_JOYBUTTONDOWN&#41; &#123;<br />        if &#40;event.key.keysym.sym == SDLK_ESCAPE&#41; &#123;<br />          done=1;<br />        &#125;<br />      &#125;<br />    &#125;<br />    do &#123;<br />      frametime=CurrentTime&#40;&#41;;<br />    &#125; while &#40;frametime&lt;40&gt;w - sprite_est&#91;estado&#93;.img-&gt;w&#41; / 2;<br />    dest.y=posy - &#40;sprite&#91;estado&#93;.img-&gt;h - sprite_est&#91;estado&#93;.img-&gt;h&#41; / 2;;<br />    SDL_BlitSurface&#40;sprite&#91;estado&#93;.img,NULL,superficie,&amp;dest&#41;;<br /></code></dd></dl><p>Estadísticas: Publicado por <a href="http://losersjuegos.com.ar/foro/memberlist.php?mode=viewprofile&amp;u=2158">Metalero</a> — Sab Oct 24, 2009 4:09 pm</p><hr />
]]></content>
</entry>
</feed>